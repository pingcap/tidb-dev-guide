<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Cherry-pick a Pull Request - TiDB Development Guide</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">TiDB Development Guide</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/pingcap/tidb-dev-guide" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="cherry-pick-a-pull-request"><a class="header" href="#cherry-pick-a-pull-request">Cherry-pick a Pull Request</a></h1>
<p>TiDB uses <a href="../project-management/release-train-model.html">release train model</a> and has multiple releases. Each release matches one git branch. For <code>type/bug</code> issues with <code>severity/critical</code> and <code>severity/major</code>, it is anticipated to be fixed on any <a href="https://pingcap.github.io/tidb-dev-guide/project-management/release-train-model.html#current-maintained-releases">currently maintained releases</a> if affected. Contributors and reviewers are responsible to settle the affected versions once the bug is identified as <code>severity/critical</code> or <code>severity/major</code>. Cherry-pick pull requests shall be created to port the fix to affected branches after the original pull request merged. While creating cherry-pick pull requests, bots in TiDB community could help lighten your workload.</p>
<h2 id="what-kind-of-pull-requests-need-to-cherry-pick"><a class="header" href="#what-kind-of-pull-requests-need-to-cherry-pick">What kind of pull requests need to cherry-pick?</a></h2>
<p>Because there are more and more releases of TiDB and limits of developer time, we are not going to cherry-pick every pull request. Currently, only problems with <code>severity/critical</code> and <code>severity/major</code> are candidates for cherry-pick. There problems shall be solved on all affected <a href="https://pingcap.github.io/tidb-dev-guide/project-management/release-train-model.html#current-maintained-releases">maintained releases</a>. Check <a href="issue-triage.html">Issue Triage chapter</a> for severity identification.</p>
<h2 id="create-cherry-pick-pull-requests-automatically"><a class="header" href="#create-cherry-pick-pull-requests-automatically">Create cherry-pick pull requests automatically</a></h2>
<p>Typically, TiDB repos use ti-chi-bot to help contributors create cherry-pick pull requests automatically.</p>
<p><code>ti-chi-bot</code> creates corresponding cherry-pick pull requests according to the <code>needs-cherry-pick-&lt;release-branch-name&gt;</code> on the original pull request once it's merged. If there is any failure or omission, contributors could run <code>/cherry-pick &lt;release-branch-name&gt;</code> to trigger cherry-pick for a specific release.</p>
<h2 id="create-cherry-pick-pull-requests-manually"><a class="header" href="#create-cherry-pick-pull-requests-manually">Create cherry-pick pull requests manually</a></h2>
<p>Contributors could also create cherry-pick pull requests manually if they want. <a href="https://git-scm.com/docs/git-cherry-pick">git cherry-pick</a> is a good command for this. The requirements in <a href="contribute-code.html">Contribute Code</a> also apply here.</p>
<h2 id="pass-triage-complete-check"><a class="header" href="#pass-triage-complete-check">Pass triage complete check</a></h2>
<p>For pull requests, <code>check-issue-triage-complete</code> checker will first check whether the <a href="https://pingcap.github.io/tidb-dev-guide/contribute-to-tidb/contribute-code.html#referring-to-an-issue">corresponding issue</a> has any <code>type/xx</code> label, if not, the checker fails. Then for issues with <code>type/bug</code> label, there must also exist a <code>severity/xx</code> label, otherwise, the checker fails. For <code>type/bug</code> issue with <code>severity/critical</code> or <code>severity/major</code> label, the checker checks if there is any <code>may-affects-x.y</code> label, which means the issue has not been diagnosed on all needed versions. If there is, the pull request is blocked and not able to be merged. So in order to merge a bugfix pull request into the target branch, every other effective version needs to first be diagnosed. TiDB maintainer will add these labels.</p>
<p>ti-chi-bot will automatically trigger the checker to run on the associated PR by listening to the labeled/unlabeled event of <code>may-affects-x.y</code> labels on bug issues, contributors also could comment <code>/check-issue-triage-complete</code> or <code>/run-check-issue-triage-complete</code> like other checkers to rerun the checker manually and update the status. Once <code>check-issue-triage-complete</code> checker passes, ti-chi-bot will add <code>needs-cherry-pick-&lt;release-version&gt;</code>/<code>needs-cherry-pick-&lt;release-branch-name&gt;</code>  labels to pull requests according to the <code>affects-x.y</code> labels on the corresponding issues.</p>
<p>In addition, if the checker fails, the robot will add the <code>do-not-merge/needs-triage-completed</code> label to the pull request at the same time, which will be used by other plugins like <a href="https://book.prow.tidb.io/#/en/plugins/tars">tars</a>.</p>
<h2 id="review-cherry-pick-pull-requests"><a class="header" href="#review-cherry-pick-pull-requests">Review cherry-pick pull requests</a></h2>
<p>Cherry-pick pull requests obey the <a href="review-a-pr.html">same review rules</a> as other pull requests. Besides the merge requirements as normal pull requests, cherry-pick pull requests are added <code>do-not-merge/cherry-pick-not-approved</code> label initially. To get it merged, it needs an additional <code>cherry-pick-approved</code> label from team <em>qa-release-merge</em>.</p>
<h2 id="troubleshoot-cherry-pick"><a class="header" href="#troubleshoot-cherry-pick">Troubleshoot cherry-pick</a></h2>
<ul>
<li>If there is any error in the cherry-pick process, for example, the bot fails to create some cherry-pick pull requests. You could ask reviewers/committers/maintainers for help.</li>
<li>If there are conflicts in the cherry-pick pull requests. You must <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/addressing-merge-conflicts/about-merge-conflicts">resolve the conflicts</a> to get pull requests merged. Some ways can solve it:
<ul>
<li>Request privileges to the forked repo by sending <code>/cherry-pick-invite</code> comment in the cherry-pick pull request if you are a member of the orgnization. When you accepted the invitaion, you could directly push to the pull request branch.</li>
<li>Ask committers/maintainers to do that for you if you are not a member of the orgnization.</li>
<li>Manually create a new cherry-pick pull request for the branch.</li>
</ul>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../contribute-to-tidb/contribute-code.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../contribute-to-tidb/review-a-pr.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../contribute-to-tidb/contribute-code.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../contribute-to-tidb/review-a-pr.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
