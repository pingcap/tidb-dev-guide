<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Review a Pull Request - TiDB Development Guide</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">TiDB Development Guide</a></li><li class="chapter-item expanded "><a href="../get-started/introduction.html"><strong aria-hidden="true">1.</strong> Get Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../get-started/install-golang.html"><strong aria-hidden="true">1.1.</strong> Install Golang</a></li><li class="chapter-item expanded "><a href="../get-started/build-tidb-from-source.html"><strong aria-hidden="true">1.2.</strong> Get the code, build and run</a></li><li class="chapter-item expanded "><a href="../get-started/setup-an-ide.html"><strong aria-hidden="true">1.3.</strong> Setup an IDE</a></li><li class="chapter-item expanded "><a href="../get-started/write-and-run-unit-tests.html"><strong aria-hidden="true">1.4.</strong> Write and run unit tests</a></li><li class="chapter-item expanded "><a href="../get-started/commit-code-and-submit-a-pull-request.html"><strong aria-hidden="true">1.5.</strong> Commit code and submit a pull request</a></li><li class="chapter-item expanded "><a href="../get-started/debug-and-profile.html"><strong aria-hidden="true">1.6.</strong> Debug and profile</a></li></ol></li><li class="chapter-item expanded "><a href="../contribute-to-tidb/introduction.html"><strong aria-hidden="true">2.</strong> Contribute to TiDB</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../contribute-to-tidb/community-guideline.html"><strong aria-hidden="true">2.1.</strong> Community Guideline</a></li><li class="chapter-item expanded "><a href="../contribute-to-tidb/committer-guide.html"><strong aria-hidden="true">2.2.</strong> Committer Guide</a></li><li class="chapter-item expanded "><a href="../contribute-to-tidb/report-a-bug.html"><strong aria-hidden="true">2.3.</strong> Report a Bug</a></li><li class="chapter-item expanded "><a href="../contribute-to-tidb/make-a-proposal.html"><strong aria-hidden="true">2.4.</strong> Make a Proposal</a></li><li class="chapter-item expanded "><a href="../contribute-to-tidb/contribute-code.html"><strong aria-hidden="true">2.5.</strong> Contribute Code</a></li><li class="chapter-item expanded "><a href="../contribute-to-tidb/review-a-pr.html" class="active"><strong aria-hidden="true">2.6.</strong> Review a Pull Request</a></li><li class="chapter-item expanded "><a href="../contribute-to-tidb/code-style-and-quality-guide.html"><strong aria-hidden="true">2.7.</strong> Code Style and Quality Guide</a></li><li class="chapter-item expanded "><a href="../contribute-to-tidb/write-document.html"><strong aria-hidden="true">2.8.</strong> Write Document</a></li></ol></li><li class="chapter-item expanded "><a href="../understand-tidb/introduction.html"><strong aria-hidden="true">3.</strong> Understand TiDB</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../understand-tidb/mysql-protocol-and-session-management.html"><strong aria-hidden="true">3.1.</strong> MySQL protocol &amp; session sanagement</a></li><li class="chapter-item expanded "><a href="../understand-tidb/the-lifecycle-of-a-sql.html"><strong aria-hidden="true">3.2.</strong> The lifecycle of a SQL</a></li><li class="chapter-item expanded "><a href="../understand-tidb/privilege-management.html"><strong aria-hidden="true">3.3.</strong> Privilege management</a></li><li class="chapter-item expanded "><a href="../understand-tidb/ddl.html"><strong aria-hidden="true">3.4.</strong> DDL</a></li><li class="chapter-item expanded "><a href="../understand-tidb/dml.html"><strong aria-hidden="true">3.5.</strong> DML</a></li><li class="chapter-item expanded "><a href="../understand-tidb/transaction-processing.html"><strong aria-hidden="true">3.6.</strong> Transaction processing</a></li><li class="chapter-item expanded "><a href="../understand-tidb/overview-of-planner.html"><strong aria-hidden="true">3.7.</strong> Overview of planner</a></li><li class="chapter-item expanded "><a href="../understand-tidb/logical-optimization-and-rules.html"><strong aria-hidden="true">3.8.</strong> Logical optimization &amp; rules</a></li><li class="chapter-item expanded "><a href="../understand-tidb/physical-optimization.html"><strong aria-hidden="true">3.9.</strong> Physical optimization</a></li><li class="chapter-item expanded "><a href="../understand-tidb/table-statistics.html"><strong aria-hidden="true">3.10.</strong> Table statistics</a></li><li class="chapter-item expanded "><a href="../understand-tidb/plan-cache.html"><strong aria-hidden="true">3.11.</strong> Plan cache</a></li><li class="chapter-item expanded "><a href="../understand-tidb/sql-plan-management.html"><strong aria-hidden="true">3.12.</strong> SQL hints and plan management</a></li><li class="chapter-item expanded "><a href="../understand-tidb/overview-of-the-execution-engine.html"><strong aria-hidden="true">3.13.</strong> Overview of the execution engine</a></li><li class="chapter-item expanded "><a href="../understand-tidb/communicate-with-the-storage.html"><strong aria-hidden="true">3.14.</strong> Retrieving data from the storage layer</a></li><li class="chapter-item expanded "><a href="../understand-tidb/mvcc-garbage-collection.html"><strong aria-hidden="true">3.15.</strong> MVCC garbage collection</a></li></ol></li><li class="chapter-item expanded "><a href="../project-management/introduction.html"><strong aria-hidden="true">4.</strong> Project Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../project-management/tidb-release-management.html"><strong aria-hidden="true">4.1.</strong> TiDB release management</a></li><li class="chapter-item expanded "><a href="../project-management/manage-a-project.html"><strong aria-hidden="true">4.2.</strong> Manage a project</a></li><li class="chapter-item expanded "><a href="../project-management/communication-and-discussion.html"><strong aria-hidden="true">4.3.</strong> Communication and discussion</a></li><li class="chapter-item expanded "><a href="../project-management/useful-resources.html"><strong aria-hidden="true">4.4.</strong> Useful resources</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">TiDB Development Guide</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/rust-lang/book" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                        

                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="how-to-review-a-pull-request"><a class="header" href="#how-to-review-a-pull-request">How to Review a Pull Request</a></h1>
<p>This guide is for contributors who want to contribute to the code review. Thank you for your effort. A good review of code is crucial for an open source project.</p>
<p>This guide is intended to help both the contributors and reviewers to ensure the following:</p>
<ul>
<li>The review keeps the high quality of TiDB code.</li>
<li>Reviewers cover all important aspects of a contribution</li>
<li>Contributors have a good contribution experience..</li>
<li>The review avoids situations in which contributors and reviewers spend a lot of time refining a contribution that gets rejected later.</li>
</ul>
<h2 id="things-to-know-before-the-code-review"><a class="header" href="#things-to-know-before-the-code-review">Things to know before the code review</a></h2>
<p>Why is code review so important?</p>
<ul>
<li>A good review can eliminate bugs early.</li>
<li>A good review can make the project maintainable in the long run.</li>
</ul>
<p>To conduct a good review, it is always helpful to read the following high-level guidelines about code review in the TiDB community:</p>
<h3 id="code-review-is-more-important-than-writing-your-own-pr"><a class="header" href="#code-review-is-more-important-than-writing-your-own-pr">Code review is more important than writing your own PR</a></h3>
<p>Nowadays software development is no longer a single personâ€™s piece of art but the result of team cooperation. To speed up the development and make the processing scale, it is important to avoid blocking. If all developers in an organization prioritize writing code over reviewing code, more and more PRs waiting for code review get blocked, and the whole team slows down.</p>
<h3 id="its-the-pr-authors-responsibility-to-get-the-pr-merged"><a class="header" href="#its-the-pr-authors-responsibility-to-get-the-pr-merged">It's the PR author's responsibility to get the PR merged</a></h3>
<p>Because PR authors are the ones who want to merge the PRs into the repository the most, after an offline discussion we agree on the following:</p>
<ul>
<li>PR authors are responsible for getting PRs reviewed and merged.</li>
<li>PR reviewers are responsible for reviewing PRs and providing feedback in time but not responsible for pushing the PR to be merged.</li>
</ul>
<h3 id="two-approvals-for-a-pr-to-be-accepted"><a class="header" href="#two-approvals-for-a-pr-to-be-accepted">Two Approvals for a PR to be accepted</a></h3>
<p>In the TiDB community, most repositories require two approvals before a PR can be accepted. A few repositories require a different number of approvals, but two approvals are the default setting. </p>
<p>Two approvals ensure that even the original PR author resigns, there is still someone who is familiar with the code and can keep the project moving. And if the author really resigns, the code reviewer becomes the first person who is responsible for the code.</p>
<h3 id="never-approve-code-you-dont-understand"><a class="header" href="#never-approve-code-you-dont-understand">Never approve code you don't understand</a></h3>
<p>A review should be thorough enough. After the review, you should be able to explain the change details at a reasonable level to other developers. This ensures that the details of the codebase are known to more than a single person. Remember: you are responsible for the code you review; it is all about your reputation.</p>
<h3 id="prs-are-suggested-to-be-less-than-500-lines"><a class="header" href="#prs-are-suggested-to-be-less-than-500-lines">PRs are suggested to be less than 500 lines</a></h3>
<p>The TiDB community encourages small changes in each PR and sets up five hundred lines as a guideline of PR size.</p>
<p>If a PR is too large, you can request the PR author to split the PR. If a PR is too large but hard to split, you can request the author to have a meeting in person to explain the changes, until you fully understand the changes.</p>
<h3 id="one-pr-does-one-thing"><a class="header" href="#one-pr-does-one-thing">One PR does one thing</a></h3>
<p>To make a PR easier to understand and get merged faster, it should focus on one thing.</p>
<p>For example, a bug fix should be in one PR and a refactoring in another. No matter how small it is, the change does exactly one thing and gets it right.</p>
<h3 id="principles-of-the-code-review"><a class="header" href="#principles-of-the-code-review">Principles of the code review</a></h3>
<ul>
<li>Technical facts and data overrule opinions and personal preferences.</li>
<li>Software design is about trade-offs, and there is no silver bullet.</li>
</ul>
<p>Everyone comes from different technical backgrounds with different knowledge. They have their own personal preferences. It is important that the code review is not based on biased opinions.</p>
<p>A common mistake is to focus too much on style. Style is important: that's why there are style guides. Just let the bot do most of the trivial work. Each PR reviewer is a human who is supposed to focus on things beyond what a bot can do. When you are reviewing a PR, make sure that the changes do not break the program logic or increase the code base maintenance cost.</p>
<p>Sometimes, making choices of accepting or rejecting a PR can be tricky as in the following situations: </p>
<ul>
<li>Suppose that a PR contains special optimization that can improve the overall performance by 30%. However, the PR introduces a totally different code path, and every subsequent feature must consider it.</li>
<li>Suppose that a PR is to fix a critical bug, but the change in the PR is risky to introduce other bugs.</li>
</ul>
<p>If a PR under your review is in these tricky situations, what is the right choice, accepting the PR or rejecting it? The answer is always &quot;it depends.&quot; Software design is more like a kind of art than technology. It is about aesthetics and your taste of the code. There are always trade-offs, and often there's no perfect solution. Still, there is a general standard (from <a href="https://github.com/shenli">@shenli</a>). Maybe we call it, &quot;Better than before?&quot;:</p>
<ul>
<li>The change is making something better, although not a perfect solution.</li>
<li>The change can mitigate the pains of users.</li>
<li>The change does not introduce a bug.</li>
</ul>
<p>Then, we can accept the code.</p>
<p>Besides, you should also check some minimal requirements of code reviews.</p>
<p>If a bug fix PR doesn't include a test case, the review should ask the author to add tests.</p>
<p>If a performance improvement PR doesn't include a benchmark result, the reviewer should ask the author to attach one.</p>
<h2 id="what-to-check-in-a-code-review"><a class="header" href="#what-to-check-in-a-code-review">What to check in a code review</a></h2>
<h3 id="design"><a class="header" href="#design">Design</a></h3>
<p>The most important thing of a review is checking the overall design.</p>
<p>To learn the overall design of a PR, you can read the description of the PR. If the description is unclear or hard to understand, you can request the author to improve it. You may consider asking questions such as the following:</p>
<ul>
<li>Does the change integrate well with the rest of our system?</li>
<li>Is now a good time to add this functionality?</li>
</ul>
<p>If you need a further discussion of the PR, you can go to <a href="https://internals.tidb.io/">TiDB Internals forum</a>. For pull requests that are created without prior consensus, try to seek consensus there too.</p>
<h3 id="functionality"><a class="header" href="#functionality">Functionality</a></h3>
<ul>
<li>Does this PR implement what the PR author intends to do?</li>
<li>How will implementing this PR help the user?</li>
</ul>
<p>Basically, PR authors are supposed to sufficiently test their PRs before code reviews. However, as a reviewer, you should still think about edge cases, especially for problems about concurrency.</p>
<p>You can always validate the PR if you want. </p>
<p>For some changes such as UI, it is hard to understand how the changes will impact users when you are just reading the code. In this case, if it is too inconvenient to try it yourself, you can ask the PR author to give you a demo of the functionality.</p>
<h3 id="logic"><a class="header" href="#logic">Logic</a></h3>
<p>When concurrent programming is involved, it is particularly important to review the logic carefully, because the concurrent issues are very hard to detect by just running the code.</p>
<h3 id="complexity"><a class="header" href="#complexity">Complexity</a></h3>
<p>Is the PR more complex than it should be? To learn that, you can check the following items when reviewing the complexity of the PR:</p>
<ul>
<li>Are individual lines too complex?</li>
<li>Are functions too complex?</li>
<li>Are classes too complex?</li>
</ul>
<p>&quot;Too complex&quot; usually means &quot;the code changes cannot be understood quickly by readers&quot; or &quot;PR authors are likely to introduce bugs when they try to call or modify the code&quot;.</p>
<p>A particular type of complexity is over-engineering, which means that PR authors have made the code more generic than it needs to be, or added functionality that is not presently needed by the system. Reviewers should be especially vigilant about over-engineering. The TiDB community encourages PR authors to solve the problems that must be solved now -- not the problems that might need to be solved in the future. </p>
<h3 id="tests"><a class="header" href="#tests">Tests</a></h3>
<p>A PR should be test covered, whether the tests are unit tests, integration tests, or end-to-end tests.</p>
<p>To ensure the tests in the PR are correct, sensible, and useful, you can check the following:</p>
<ul>
<li>Whether the tests cover all interesting cases?</li>
<li>Are the test cases readable?</li>
<li>Does the PR lower the overall test coverage? </li>
</ul>
<p>To ensure the tests in the PR are sufficient, you can simulate cases where the code may break and check the following:</p>
<ul>
<li>Will the tests fail when the code is broken?</li>
<li>Does each test make simple and useful assertions?</li>
<li>Are the tests separated appropriately between different test methods?</li>
</ul>
<p>Remember that tests are also code that have to be maintained, and thus do not accept unnecessary complexity in tests.</p>
<p>Last but not least, keep an eye on how long a single unit takes to run. That is, determine whether the test slow down the CI.</p>
<h3 id="naming"><a class="header" href="#naming">Naming</a></h3>
<p>Does the PR author pick good names for everything? A good name should be clear enough to fully communicate what the item is or does.</p>
<h3 id="comments"><a class="header" href="#comments">Comments</a></h3>
<ul>
<li>Does the PR author write clear comments in understandable English?</li>
<li>Are all of the comments actually necessary?</li>
</ul>
<p>Usually, comments are useful to explain why the code exists, while not useful to explain what the code is doing. If the code is not clear enough to explain itself, the PR author should simplify the code instead of adding unnecessary comments.</p>
<p>However, there are some exceptions. For example, the comments to explain what regular expressions or complex algorithms is doing are greatly helpful. But in other cases, comments are mostly for information, such as a reason behind a decision.</p>
<p>It can also be helpful to look at the existing comments before this PR. Maybe a <code>TODO</code> in the existing comments can be removed now, or there is a comment advising against the current changes, etc.</p>
<p>Note that comments are different from documentation of classes, modules, or functions, which covers the purpose of a piece of code, how the code should be used, and how the code behaves when being used.</p>
<h3 id="style"><a class="header" href="#style">Style</a></h3>
<p>Make sure the PR follows our <a href="code-style-and-quality-guide.html">code style and quality guide</a>. For Go and Rust, there are built-in tools with the compiler toolchain.</p>
<p>If you want to improve styles not covered in the style guide, you can comment that you think it would improve the code readability but it is not mandatory. Do not block PRs from being merged based only on personal style preferences.</p>
<p>The PR author should not combine nontrivial style changes and functional changes in one PR, because it violates the guideline covered earlier: one PR does one thing.</p>
<h3 id="consistency"><a class="header" href="#consistency">Consistency</a></h3>
<p>What if the existing code is inconsistent with the style guide? The style guide is the absolute authority: if something is required by the style guide, the PR should follow the guidelines.</p>
<p>In some cases, the style guide only makes recommendations but does not declare requirements. In these cases, it is a judgment call whether the new code should be consistent with the recommendations in the style guide or with the surrounding code. It is recommended that you follow the style guide unless the local inconsistency is too confusing.</p>
<p>If no other rule applies, the PR author should maintain consistency with the existing code.</p>
<p>In either way, you can encourage the author to file a bug and add a TODO for cleaning up existing code.</p>
<h3 id="documentation"><a class="header" href="#documentation">Documentation</a></h3>
<p>During the code review, if you notice that a PR changes how users build, test, interact with, or release code, you must check whether it also updates the related documentation such as READMEs and any generated reference docs. </p>
<p>Similarly, if a PR deletes or deprecates code, you must check whether or not the corresponding documentation should also be deleted.</p>
<p>If any documentation updates are missing, you can request the PR author to add the updates.</p>
<h4 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h4>
<p>Because errors and exceptions handling are one of the most possible places for bugs, during the code review, you must be as prudent as possible and ask yourself the following questions: </p>
<ul>
<li>Does the test of the PR cover the error code path?</li>
<li>Does a panic make the whole process exit for server services?</li>
<li>Does the code properly handle the resource releasing?</li>
<li>Especially for code including concurrent goroutines, is there a goroutine leak or memory leak after the error?</li>
</ul>
<p>Sometimes, it is difficult for a real program to run into the error code path, and even more difficult to reproduce and debug if the error really happens. In this case, it is necessary to mock the error code path using tools such as <a href="https://github.com/pingcap/failpoint">failpoint</a>.</p>
<h3 id="performance"><a class="header" href="#performance">Performance</a></h3>
<p>Does the PR impact performance? Sometimes, a seemingly minor, unrelated change on the hot may still affect performance.</p>
<p>Is the algorithm in the PR suitable for that case?</p>
<h2 id="how-to-write-code-review-comments"><a class="header" href="#how-to-write-code-review-comments">How to write code review comments</a></h2>
<h3 id="be-respectful-to-pr-authors"><a class="header" href="#be-respectful-to-pr-authors">Be respectful to PR authors</a></h3>
<p>Good reviewers are compassionate. While you are reviewing the code of a PR author, at the same time, your own code might be under the review of other reviewers too. If you regard code review as a learning process, then everyone wins.</p>
<h3 id="ask-questions-instead-of-making-statements"><a class="header" href="#ask-questions-instead-of-making-statements">Ask questions instead of making statements</a></h3>
<p>The wording of the review comments is very important. To provide review comments that are constructive rather than critical, you can try asking questions rather than making statements. Along with your constructive feedback, you are recommended to give your praise too.</p>
<h3 id="offer-sincere-praise"><a class="header" href="#offer-sincere-praise">Offer sincere praise</a></h3>
<p>Good PR reviewers focus not only on what is wrong with the code but also on good practices in the code. As a PR reviewer, you are recommended to offer your encouragement and appreciation to PR authors for the good practices in the code. In terms of mentoring, telling PR authors what they did is right is even more valuable than telling them what they did is wrong.</p>
<p>For example, suppose that you are reviewing a PR created by an author who struggles to write documentation, and you come across a clear, concise function comment in the PR. Then, you are recommended to tell such PR authors that they nailed it. To help the PR authors improve faster, tell the authors when they get it right instead of just waiting to ding them when they screw up.</p>
<h3 id="summary"><a class="header" href="#summary">Summary</a></h3>
<ul>
<li>Be kind to PR authors, not to the code.</li>
<li>Ask questions instead of making statements.</li>
<li>Treat people who know code less than you with respect, deference, and patience.</li>
<li>Offer your praise when the code quality exceeds your expectation.</li>
<li>It is not necessarily wrong if the solution of a PR author is different from yours.</li>
<li>Refer to the code style document if necessary.</li>
</ul>
<h2 id="review-with-the-ti-chi-bot"><a class="header" href="#review-with-the-ti-chi-bot">Review with the @ti-chi-bot</a></h2>
<p>The TiDB community uses a service called <a href="https://book.prow.tidb.io/#/en/">@ti-chi-bot</a> to help with the review of the pull requests.</p>
<p>You can see the full list of commands accepted by the bot at <a href="https://prow.tidb.io/command-help?repo=pingcap%2Ftidb">this page</a>.</p>
<p>Here are the most frequently used commands you're going to use during a review:</p>
<ul>
<li><code>/cc @reviewer</code> requests a review from the reviewer.</li>
<li><code>/assign @committer</code> assigns a committer to help merge the pull request</li>
<li>GitHub reviewing <code>Approve</code> or <code>Request Changes</code> from reviewers or committers creates a LGTM or veto to the pull request.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../contribute-to-tidb/contribute-code.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../contribute-to-tidb/code-style-and-quality-guide.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../contribute-to-tidb/contribute-code.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../contribute-to-tidb/code-style-and-quality-guide.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
